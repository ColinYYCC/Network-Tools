# åƒè€ƒLucyï¼ˆ@Repczï¼‰
# Author:https://github.com/ColinYYCC
#
# å®˜æ–¹æ–‡æ¡£ï¼šhttps://wiki.metacubex.one/
#
# ä»¥ '#' æˆ– '//' å¼€å¤´çš„é…ç½®æ–‡ä»¶è¡Œä¸ºæ³¨é‡Šè¡Œ
#
# Mihomo Version â‰¥ 1.8.4
#
# ================

proxy-providers:
  Subscribe: {url: http://your-service-provider, path: ./proxy-providers/Sub.yaml, type: http, interval: 86400, health-check: {enable: true, url: http://latency-test.skk.moe/endpoint, interval: 1800}}
  # åœ¨æ­¤å°†"http://your-service-provider"æ›¿æ¢ä¸ºä½ çš„æœºåœºè®¢é˜…ï¼Œæ¨èä½¿ç”¨ base64 æˆ–è€… node list
  # Sub-Storeç”Ÿæˆçš„é“¾æ¥,å¯ä»¥ç›´æ¥æ›¿æ¢ä¸Šè¿° url å¼•å·ä¸­çš„éƒ¨åˆ†,å…·ä½“è§ Sub-Store æ•™ç¨‹         

# æ··åˆç«¯å£ HTTPå’ŒSOCKS5ç”¨ä¸€ä¸ªç«¯å£
mixed-port: 7893
# TCP å¹¶å‘è¿æ¥æ‰€æœ‰ IP, å°†ä½¿ç”¨æœ€å¿«æ¡æ‰‹çš„ TCP
tcp-concurrent: true
# å…è®¸å±€åŸŸç½‘çš„è¿æ¥ï¼ˆå¯ç”¨æ¥å…±äº«ä»£ç†ï¼‰
allow-lan: true
# å¼€å¯ IPv6 æ€»å¼€å…³ï¼Œå…³é—­é˜»æ–­æ‰€æœ‰ IPv6 é“¾æ¥å’Œå±è”½ DNS è¯·æ±‚ AAAA è®°å½•  
ipv6: false
# è®¾ç½®æ—¥å¿—è¾“å‡ºçº§åˆ«: silent/error/warning/info/debug
log-level: info
unified-delay: true
# å…¨å±€ TLS æŒ‡çº¹
global-client-fingerprint: chrome
# åŒ¹é…æ‰€æœ‰è¿›ç¨‹ï¼ˆalways/strict/offï¼‰
find-process-mode: strict
external-controller: 127.0.0.1:9090
external-ui: ui
external-ui-url: "https://github.com/MetaCubeX/metacubexd/archive/refs/heads/gh-pages.zip"

# ä½¿ç”¨geoip.datæ•°æ®åº“
geodata-mode: true
geox-url:
  geoip: "https://github.com/xream/geoip/releases/latest/download/ipinfo.geoip.dat"
  geosite: "https://mirror.ghproxy.com/https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geosite.dat"
  mmdb: "https://github.com/xream/geoip/releases/latest/download/ipinfo.country.mmdb"
  asn: "https://github.com/xream/geoip/releases/latest/download/ipinfo.asn.mmdb"

profile:
  # å­˜å‚¨ select é€‰æ‹©è®°å½•
  store-selected: true 
  # æŒä¹…åŒ– fake-ip
  store-fake-ip: true  

# å—…æ¢åŸŸå å¯é€‰é…ç½®
sniffer:
  enable: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]

# Tun é…ç½®  
tun:
  enable: true
  # å¯é€‰ï¼š system/gvisor/mixedï¼›
  stack: mixed
  # dnsåŠ«æŒ,ä¸€èˆ¬è®¾ç½®ä¸º any:53 å³å¯, å³åŠ«æŒæ‰€æœ‰53ç«¯å£çš„udpæµé‡
  dns-hijack: [8.8.8.8:53, 8.8.4.4:53]
        
dns:
  enable: true
  # IPV6è§£æå¼€å…³ï¼›å¦‚æœä¸ºfalseï¼Œå°†è¿”å›ipv6ç»“æœä¸ºç©º
  ipv6: false
  # æ¨¡å¼ï¼šredir-hostæˆ–fake-ip
  enhanced-mode: fake-ip
  # DNSç›‘å¬åœ°å€
  listen: :1053
  # Fake-IPè§£æåœ°å€æ± 
  fake-ip-range: 28.0.0.1/8
  # fakeip è¿‡æ»¤ï¼Œä»¥ä¸‹åœ°å€ä¸ä¼šä¸‹å‘ fakeip æ˜ å°„ç”¨äºè¿æ¥
  fake-ip-filter: ['+.lan', '*', '+.local']
  #é»˜è®¤çš„åŸŸåè§£ææœåŠ¡å™¨
  default-nameserver: [9.9.9.9, 149.112.112.112]
  nameserver: [9.9.9.9, 149.112.112.112]
  nameserver-policy:
    'geosite:cn': system
    'geosite:gfw,geolocation-!cn': [quic://223.5.5.5, quic://223.6.6.6, https://1.12.12.12/dns-query, https://120.53.53.53/dns-query]

# é”šç‚¹å‚æ•°
pg: &pg {type: select, proxies: [æ‰‹åŠ¨åˆ‡æ¢, é¦™æ¸¯èŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, æ—¥æœ¬èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, éŸ©å›½èŠ‚ç‚¹, ğŸ”¯ æ•…éšœè½¬ç§», ğŸ”® è´Ÿè½½å‡è¡¡, DIRECT]}
# è®¢é˜…æ›´æ–°å’Œå»¶è¿Ÿæµ‹è¯•ç›¸å…³å‚æ•°
p: &p {type: http, interval: 86400, health-check: {enable: true, url: http://latency-test.skk.moe/endpoint, interval: 1800}}
# è‡ªåŠ¨é€‰æ‹©ç­–ç•¥ç»„ï¼šé€‰å–å»¶è¿Ÿæœ€ä½èŠ‚ç‚¹
url-test: &url-test {type: url-test, lazy: true, url: http://latency-test.skk.moe/endpoint, interval: 300, tolerance: 0, include-all: true}
# æ‰‹åŠ¨é€‰æ‹©ç­–ç•¥ç»„ï¼šæ‰‹åŠ¨é€‰æ‹©æƒ³è¦çš„èŠ‚ç‚¹/ç­–ç•¥ç»„
select: &select {type: select, include-all: true}
# æ•…éšœå›é€€ç­–ç•¥ç»„ï¼šç­–ç•¥ç»„å°†æŒ‰é¡ºåºé€‰æ‹©ä½ åˆ—è¡¨ä¸­ç¬¬ä¸€ä¸ªå¯ç”¨çš„èŠ‚ç‚¹
fallback: &fallback {type: fallback, lazy: true, url: http://latency-test.skk.moe/endpoint, interval: 300, include-all: true}
# è´Ÿè½½å‡è¡¡ç­–ç•¥ç»„ï¼šä¸åŒçš„è¯·æ±‚å°†ä½¿ç”¨ä¸åŒçš„ä»£ç†èŠ‚ç‚¹
load-balance: &load-balance {type: load-balance, lazy: true, strategy: consistent-hashing, url: http://latency-test.skk.moe/endpoint, interval: 300, include-all: true}
# classicalè§„åˆ™ç›¸å…³
c: &c {type: http, behavior: classical, format: text, interval: 86400}
# domainè§„åˆ™ç›¸å…³
d: &d {type: http, behavior: domain, format: text, interval: 86400}
# ipcidrè§„åˆ™ç›¸å…³
i: &i {type: http, behavior: ipcidr, format: text, interval: 86400}

proxy-groups:

  - {name: æ‰‹åŠ¨åˆ‡æ¢, type: select, include-all: true, proxies: [ğŸ›°ï¸ è‡ªåŠ¨é€‰æ‹©, é¦™æ¸¯èŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, æ—¥æœ¬èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, éŸ©å›½èŠ‚ç‚¹, ğŸ”® è´Ÿè½½å‡è¡¡, DIRECT], icon: https://raw.githubusercontent.com/Semporia/Hand-Painted-icon/master/Universal/Auto_Speed.png}
  - {name: å›½å¤–ç½‘ç«™, <<: *pg, icon: https://raw.githubusercontent.com/tugepaopao/Image-Storage/master/hand-painted/56.png}
  - {name: å›½é™…åª’ä½“, <<: *pg, icon: https://raw.githubusercontent.com/Semporia/Hand-Painted-icon/master/Universal/Netflix.png}
  - {name: è‹¹æœæœåŠ¡, <<: *pg, icon: https://raw.githubusercontent.com/Semporia/Hand-Painted-icon/master/Social_Media/Apple.png}
  - {name: å¾®è½¯æœåŠ¡, <<: *pg, icon: https://raw.githubusercontent.com/Semporia/Hand-Painted-icon/master/Universal/Microsoft.png}
  - {name: è°·æ­ŒæœåŠ¡, <<: *pg, icon: https://github.com/tugepaopao/Image-Storage/raw/master/cartoon/Cute/google.png}
  - {name: ç”µæŠ¥æ¶ˆæ¯, <<: *pg, icon: https://github.com/tugepaopao/Image-Storage/raw/master/hand-painted/36.png}
  - {name: æ¨ç‰¹æ¶ˆæ¯, <<: *pg, icon: https://raw.githubusercontent.com/Semporia/Hand-Painted-icon/master/Social_Media/Twitter.png}
  - {name: AI, <<: *pg, https://raw.githubusercontent.com/Orz-3/mini/master/Color/OpenAI.png}
  - {name: æ¸¸æˆå¹³å°, <<: *pg, icon: https://github.com/tugepaopao/Image-Storage/raw/master/hand-painted/35.png}
  - {name: Emby, <<: *pg, include-all: true, icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Emby.png}
  - {name: å¹¿å‘Šæ‹¦æˆª, type: select, proxies: [REJECT, DIRECT], icon: https://raw.githubusercontent.com/Semporia/Hand-Painted-icon/master/Universal/Reject.orig.png}
  - {name: æ¼ç½‘ä¹‹é±¼, type: select, include-all: true, proxies: [ğŸ›°ï¸ è‡ªåŠ¨é€‰æ‹©, é¦™æ¸¯èŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, æ—¥æœ¬èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, éŸ©å›½èŠ‚ç‚¹, ğŸ”® è´Ÿè½½å‡è¡¡, DIRECT], icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Final.png}
  - {name: é¦™æ¸¯èŠ‚ç‚¹, <<: *fallback, filter: "^(?=.*((?i)ğŸ‡­ğŸ‡°|é¦™æ¸¯|(\b(HK|Hong)\b))).*$", hidden: true, icon: https://raw.githubusercontent.com/Semporia/Hand-Painted-icon/master/Rounded_Rectangle/Hong_Kong.png}
  - {name: éŸ©å›½èŠ‚ç‚¹, <<: *fallback, filter: "^(?=.*((?i)ğŸ‡°ğŸ‡·|éŸ©å›½|éŸ“|é¦–å°”|(\b(KR|Korea)\b))).*$", hidden: true, icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/China.png}
  - {name: ç¾å›½èŠ‚ç‚¹, <<: *fallback, filter: "^(?=.*((?i)ğŸ‡ºğŸ‡¸|ç¾å›½|æ³¢ç‰¹å…°|è¾¾æ‹‰æ–¯|ä¿„å‹’å†ˆ|å‡¤å‡°åŸ|è´¹åˆ©è’™|ç¡…è°·|æ‹‰æ–¯ç»´åŠ æ–¯|æ´›æ‰çŸ¶|åœ£ä½•å¡|åœ£å…‹æ‹‰æ‹‰|è¥¿é›…å›¾|èŠåŠ å“¥|(\b(US|United States)\b))).*$", hidden: true, icon: https://raw.githubusercontent.com/Semporia/Hand-Painted-icon/master/Rounded_Rectangle/United_States.png}
  - {name: ç‹®åŸèŠ‚ç‚¹, <<: *fallback, filter: "^(?=.*((?i)ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|ç‹®|(\b(SG|Singapore)\b))).*$", hidden: true, icon: https://raw.githubusercontent.com/Semporia/Hand-Painted-icon/master/Rounded_Rectangle/Singapore.png}
  - {name: æ—¥æœ¬èŠ‚ç‚¹, <<: *fallback, filter: "^(?=.*((?i)ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|å·æ—¥|ä¸œäº¬|å¤§é˜ª|æ³‰æ—¥|åŸ¼ç‰|(\b(JP|Japan)\b))).*$", hidden: true, icon: https://raw.githubusercontent.com/Semporia/Hand-Painted-icon/master/Rounded_Rectangle/Japan.png}
  - {name: å°æ¹¾èŠ‚ç‚¹, <<: *fallback, filter: "^(?=.*((?i)ğŸ‡¹ğŸ‡¼|å°æ¹¾|(\b(TW|Tai|Taiwan)\b))).*$", hidden: true, icon: https://raw.githubusercontent.com/Semporia/Hand-Painted-icon/master/Rounded_Rectangle/Taiwan.png}
  - {name: ğŸ›°ï¸ è‡ªåŠ¨é€‰æ‹©, <<: *url-test, filter: "^(?=.*(.))(?!.*((?i)ç¾¤|é‚€è¯·|è¿”åˆ©|å¾ªç¯|å®˜ç½‘|å®¢æœ|ç½‘ç«™|ç½‘å€|è·å–|è®¢é˜…|æµé‡|åˆ°æœŸ|æœºåœº|ä¸‹æ¬¡|ç‰ˆæœ¬|å®˜å€|å¤‡ç”¨|è¿‡æœŸ|å·²ç”¨|è”ç³»|é‚®ç®±|å·¥å•|è´©å–|é€šçŸ¥|å€’å–|é˜²æ­¢|å›½å†…|åœ°å€|é¢‘é“|æ— æ³•|è¯´æ˜|ä½¿ç”¨|æç¤º|ç‰¹åˆ«|è®¿é—®|æ”¯æŒ|æ•™ç¨‹|å…³æ³¨|æ›´æ–°|ä½œè€…|åŠ å…¥|(\b(USE|USED|TOTAL|EXPIRE|EMAIL|Panel|Channel|Author)\b))).*$", proxy-groups:, icon: https://raw.githubusercontent.com/Semporia/Hand-Painted-icon/master/Universal/Auto_Speed.png}
  - {name: ğŸ”® è´Ÿè½½å‡è¡¡, <<: *load-balance, filter: "^(?=.*(.))(?!.*((?i)ç¾¤|é‚€è¯·|è¿”åˆ©|å¾ªç¯|å®˜ç½‘|å®¢æœ|ç½‘ç«™|ç½‘å€|è·å–|è®¢é˜…|æµé‡|åˆ°æœŸ|æœºåœº|ä¸‹æ¬¡|ç‰ˆæœ¬|å®˜å€|å¤‡ç”¨|è¿‡æœŸ|å·²ç”¨|è”ç³»|é‚®ç®±|å·¥å•|è´©å–|é€šçŸ¥|å€’å–|é˜²æ­¢|å›½å†…|åœ°å€|é¢‘é“|æ— æ³•|è¯´æ˜|ä½¿ç”¨|æç¤º|ç‰¹åˆ«|è®¿é—®|æ”¯æŒ|æ•™ç¨‹|å…³æ³¨|æ›´æ–°|ä½œè€…|åŠ å…¥|(\b(USE|USED|TOTAL|EXPIRE|EMAIL|Panel|Channel|Author)\b))).*$", hidden: true, icon: https://raw.githubusercontent.com/Koolson/Qure/master/IconSet/Color/Available.png}

rule-providers:
  Sogouinput: {<<: *c, path: ./RuleSet/sogouinput.txt, url: https://ruleset.skk.moe/Clash/non_ip/sogouinput.txt}
  adrules: {<<: *c, path: ./RuleSet/adrules.list, url: https://adrules.top/adrules.list}
  Reject_non_ip: {<<: *c, path: ./RuleSet/reject_non_ip.txt, url: https://ruleset.skk.moe/Clash/non_ip/reject.txt}
  Apple Service: {<<: *c, path: ./RuleSet/apple_services.conf,  url: https://ruleset.skk.moe/List/non_ip/apple_services.conf}
  Apple CDN: {<<: *c, path: ./RuleSet/apple_cdn.conf,  url: https://ruleset.skk.moe/List/non_ip/apple_cdn.conf}
  äº‘ä¸Šè´µå·: {<<: *c, path: ./RuleSet/apple_cdn.conf,  url: https://ruleset.skk.moe/List/non_ip/apple_cn.conf}
  YouTube: {<<: *c, path: ./rule-providers/YouTube.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/YouTube.list}
  Google: {<<: *c, path: ./rule-providers/Google.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/Google.list}
  Telegram: {<<: *c, path: ./rule-providers/Telegram.list,  url: https://github.com/LucaLin233/Luca_Conf/blob/main/Surge/Rule/Telegram.list?raw=true}
  Twitter: {<<: *c, path: ./rule-providers/Twitter.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/Twitter.list}
  Steam: {<<: *c, path: ./rule-providers/Steam.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/Steam.list}
  Epic: {<<: *c, path: ./rule-providers/Epic.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/Epic.list}
  AI: {<<: *c, path: ./rule-providers/AI.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/AI.list}
  Emby: {<<: *c, path: ./rule-providers/Emby.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/Emby.list}
  Spotify: {<<: *c, path: ./rule-providers/Spotify.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/Spotify.list}
  Bahamut: {<<: *c, path: ./rule-providers/Bahamut.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/Bahamut.list}
  Netflix: {<<: *c, path: ./rule-providers/Netflix.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/Netflix.list}
  Disney: {<<: *c, path: ./rule-providers/Disney.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/Disney.list}
  PrimeVideo: {<<: *c, path: ./rule-providers/PrimeVideo.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/PrimeVideo.list}
  HBO: {<<: *c, path: ./rule-providers/HBO.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/HBO.list}
  ChinaDomain: {<<: *c, path: ./RuleSet/ChinaDomain.list,  url: https://github.com/Repcz/Tool/raw/X/Clash/Rules/ChinaDomain.list}
  Domestic_non_ip: {<<: *c, path: ./RuleSet/domestic_non_ip.txt, url: https://ruleset.skk.moe/Clash/non_ip/domestic.txt}
  Direct_non_ip: {<<: *c, path: ./RuleSet/direct_non_ip.txt, url: https://ruleset.skk.moe/Clash/non_ip/direct.txt}
  Domestic_ip: {<<: *c, path: ./RuleSet/domestic_ip.txt, url: https://ruleset.skk.moe/Clash/ip/domestic.txt}
  China_ip: {<<: *i, path: ./RuleSet/china_ip.txt, url: https://ruleset.skk.moe/Clash/ip/china_ip.txt}

rules:
 - RULE-SET,äº‘ä¸Šè´µå·,DIRECT
  - RULE-SET,Apple CDN,DIRECT
  - RULE-SET,Sogouinput,å¹¿å‘Šæ‹¦æˆª
  - RULE-SET,adrules,å¹¿å‘Šæ‹¦æˆª
  - RULE-SET,Reject_non_ip,å¹¿å‘Šæ‹¦æˆª
  - DOMAIN-SUFFIX,zoom.us,å›½å¤–ç½‘ç«™
  - RULE-SET,AI,AI
  - RULE-SET,Apple Service,è‹¹æœæœåŠ¡
  - RULE-SET,YouTube,è°·æ­ŒæœåŠ¡
  - RULE-SET,Google,è°·æ­ŒæœåŠ¡
  - RULE-SET,Telegram,ç”µæŠ¥æ¶ˆæ¯
  - RULE-SET,Twitter,æ¨ç‰¹æ¶ˆæ¯
  - RULE-SET,Steam,æ¸¸æˆå¹³å°
  - RULE-SET,Epic,æ¸¸æˆå¹³å°
  - RULE-SET,Emby,Emby
  - RULE-SET,Spotify,å›½é™…åª’ä½“
  - RULE-SET,Bahamut,å›½é™…åª’ä½“
  - RULE-SET,Netflix,å›½é™…åª’ä½“
  - RULE-SET,Disney,å›½é™…åª’ä½“
  - RULE-SET,PrimeVideo,å›½é™…åª’ä½“
  - RULE-SET,HBO,å›½é™…åª’ä½“
  - GEOSITE,onedrive,å¾®è½¯æœåŠ¡
  - GEOSITE,github,å¾®è½¯æœåŠ¡
  - GEOSITE,microsoft,å¾®è½¯æœåŠ¡
  - GEOSITE,gfw,å›½å¤–ç½‘ç«™
  - RULE-SET,ChinaDomain,DIRECT
  - RULE-SET,Domestic_non_ip,DIRECT
  - RULE-SET,Direct_non_ip,DIRECT
  - RULE-SET,China_ip,DIRECT,no-resolve
  - RULE-SET,Domestic_ip,DIRECT,no-resolve
  - GEOIP,lan,DIRECT
  - GEOIP,CN,DIRECT
  - MATCH,æ¼ç½‘ä¹‹é±¼

url-rewrite:
    - ^https?:\/\/(www.)?(g|google)\.cn https://www.google.com 302
    - ^https?:\/\/(ditu|maps).google\.cn https://maps.google.com 302
